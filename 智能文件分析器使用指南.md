# 🎯 智能文件分析器使用指南

## 📋 功能介绍

智能文件分析器是一个基于Ollama本地AI的数据分析工具，支持从指定路径读取各种格式的数据文件，并进行智能分析和可视化。

### ✨ 主要特性

- 🔍 **多格式支持**: CSV, Excel, JSON, Parquet, TSV, TXT
- 🤖 **AI驱动分析**: 使用Ollama本地模型进行智能数据分析
- 📊 **自动图表生成**: 生成6种专业数据可视化图表
- 💬 **自然语言交互**: 支持中文问答和分析
- 🔒 **隐私保护**: 完全本地运行，数据不会上传

## 🚀 快速开始

### 1. 命令行快速分析

```bash
# 基础分析（使用默认问题）
python analyze_file.py your_data.csv

# 自定义分析问题
python analyze_file.py your_data.csv "分析销售趋势" "找出异常值" "给出业务建议"

# 分析Excel文件
python analyze_file.py data.xlsx "分析财务数据" "计算关键指标"
```

### 2. 交互式分析

```bash
python smart_file_analyzer.py
```

进入交互式模式，支持：
- 📁 浏览目录中的数据文件
- 📝 自定义分析问题
- ⚙️ 设置文件读取参数

### 3. Python代码集成

```python
from smart_file_analyzer import FileDataAnalyzer

# 创建分析器
analyzer = FileDataAnalyzer()

# 分析文件
result = analyzer.analyze_file('data.csv', [
    '分析销售数据的主要趋势',
    '找出表现最好的产品',
    '给出市场策略建议'
])

# 查看结果
print(result['analyses'])
```

## 📁 支持的文件格式

| 格式 | 扩展名 | 示例用法 |
|------|--------|----------|
| CSV | `.csv` | `analyzer.read_file('data.csv')` |
| Excel | `.xlsx`, `.xls` | `analyzer.read_file('data.xlsx', sheet_name=0)` |
| JSON | `.json` | `analyzer.read_file('data.json')` |
| Parquet | `.parquet` | `analyzer.read_file('data.parquet')` |
| TSV | `.tsv` | `analyzer.read_file('data.tsv')` |
| 文本 | `.txt` | `analyzer.read_file('data.txt')` |

## 📊 生成的图表类型

分析器会自动生成以下6种图表：

1. **数据集概览** - 基本信息统计
2. **数值列分布** - 直方图显示数值分布
3. **缺失值统计** - 数据质量分析
4. **分类列分布** - 饼图显示类别分布
5. **相关性矩阵** - 数值列之间的相关性
6. **数据质量评估** - 完整性和质量指标

## 🛠 高级用法

### 1. 自定义读取参数

```bash
# CSV文件指定编码和分隔符
python analyze_file.py data.csv --encoding=utf-8 --sep=';'
```

在Python中：
```python
# 读取带特殊参数的文件
df = analyzer.read_file('data.csv', 
                       encoding='utf-8', 
                       sep=';', 
                       header=0)

# Excel文件指定工作表
df = analyzer.read_file('data.xlsx', 
                       sheet_name='Sheet1',
                       skiprows=1)
```

### 2. 批量文件分析

```python
import os
from pathlib import Path

analyzer = FileDataAnalyzer()

# 分析目录中的所有CSV文件
data_dir = Path('data_folder')
for csv_file in data_dir.glob('*.csv'):
    print(f"分析文件: {csv_file}")
    result = analyzer.analyze_file(str(csv_file))
    print("分析完成\\n")
```

### 3. 自定义分析问题模板

```python
# 销售数据分析模板
sales_questions = [
    "分析销售额的时间趋势和季节性模式",
    "识别最佳销售渠道和产品类别", 
    "计算客户生命周期价值和留存率",
    "预测下季度销售目标和增长机会"
]

# 人力资源分析模板  
hr_questions = [
    "分析员工薪资分布和公平性",
    "评估各部门人员配置效率",
    "识别人才流失风险和关键因素",
    "制定人才招聘和培训策略"
]

# 财务数据分析模板
finance_questions = [
    "分析收入和支出结构变化",
    "计算关键财务比率和健康指标",
    "识别成本控制和利润优化机会", 
    "评估投资回报和风险管理"
]
```

## 🔧 故障排除

### 常见问题

1. **Ollama服务未启动**
   ```bash
   # 启动Ollama服务
   ollama serve
   ```

2. **模型未下载**
   ```bash
   # 下载CodeLlama模型
   ollama pull codellama:7b
   ```

3. **文件读取失败**
   - 检查文件路径是否正确
   - 确认文件格式是否支持
   - 尝试指定正确的编码格式

4. **中文显示问题**
   - 确保系统安装了中文字体
   - 图表中文字体警告不影响功能

### 性能优化

1. **大文件处理**
   ```python
   # 对于大文件，可以先采样分析
   df = analyzer.read_file('large_file.csv', nrows=10000)
   ```

2. **内存优化**
   ```python
   # 只加载需要的列
   df = analyzer.read_file('data.csv', usecols=['col1', 'col2'])
   ```

## 📈 使用示例

### 示例1: 销售数据分析

```bash
python analyze_file.py sales_data.csv \\
  "分析月度销售趋势" \\
  "找出最佳销售产品" \\
  "预测下月销售额"
```

### 示例2: 员工数据分析

```bash  
python analyze_file.py employee_data.xlsx \\
  "分析薪资分布公平性" \\
  "评估部门人员配置" \\
  "制定招聘策略"
```

### 示例3: 客户数据分析

```bash
python analyze_file.py customer_data.json \\
  "分析客户行为模式" \\
  "识别高价值客户" \\
  "制定营销策略"
```

## 🎯 最佳实践

1. **数据准备**
   - 确保数据格式规范
   - 处理明显的数据错误
   - 添加有意义的列名

2. **问题设计**
   - 提出具体明确的业务问题
   - 结合实际业务场景
   - 考虑数据的局限性

3. **结果应用**
   - 结合业务知识解读AI分析
   - 验证关键发现的准确性
   - 制定可执行的行动计划

## 🔮 扩展功能

### 计划中的功能

- 📊 更多图表类型（热力图、散点图等）
- 🔄 实时数据监控和分析
- 📱 Web界面支持
- 🤝 多人协作分析
- 📋 分析报告导出（PDF/Word）

---

**🎉 开始使用智能文件分析器，让AI帮你发现数据中的价值！**